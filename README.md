# Key-Secret-Store

Secret Store

奇偶Secret Store是实现以下目的的核心技术：

distributed elliptic curve（分布式椭圆曲线）（EC）密钥对生成-密钥是由多方使用特殊的加密协议生成的，因此：

1）私钥对于每一方来说都是未知的；

2）可以在每一方上计算公钥部分，并可以安全地暴露给外部实体；

3）各方均持有私钥的“份额”；

4）t+1各方的任何子集都可以联合起来以恢复密钥的私密部分；

5）少于 t+1各方的任何子集都无法恢复密钥的私有部分；

6）私钥不同部分由各方分别存储，并且永远不会暴露给另一方或外部；根据区块链许可进行阈值检索，所有需要私钥的操作都至少需要t+1各方同意“许可合同”状态。


1.	Node或者key server：生成EC密钥对;

2.	Secret Store：节点网路，生成密钥对；

3.	key scheme：N个节点中T+1个节点生成各自私钥部分；

4.	server key generation session：

1）	server key：EC密钥对

2）	server key id：server key标识符，最好以文档的哈希值作为唯一标识符，保证了唯一性和不可篡改性；

3）	server key share：共享机制

5.	document key generation session：生成文件密钥对

1）	document

2）	document encryption

3）	document key：由document key generation session协议生成的密钥。

6.	permissioning sessions：

1）	permissioning contract: 验证节点数量是否满足T+1

2）	document key retrieval session：恢复document key，并将其返还给请求者；

3）	signing session

4）	key servers set change session：新节点替代旧节点。





Secret Store - Wiki 

Parity Tech Documentation

The Parity Secret Store is core technology that enables:

•	distributed elliptic curve (EC) key pair generation - key is generated by several parties using special cryptographic protocol, so that:

o	private key portion remains unknown to every single party;

o	public key portion could be computed on every party and could be safely exposed to external entities;

o	every party hold the ‘share’ of the private key;

o	any subset of t+1 parties could unite to restore the private portion of the key;

o	any subset of less than t+1 parties could not restore the private portion of the key;

•	distributed key storage - private key shares are stored separately by every party and are never exposed neither to another parties, nor to external entities;

•	threshold retrieval according to blockchain permissions - all operations that are requiring private key, require at least t+1 parties to agree on ‘Permissioning contract’ 
state.

Glossary

Terms that are being used on this page:

•	node or key server: specially configured Parity instance, which can participate in distributed EC key pair generation (or related) sessions;（用于生成分布式私钥的节点）

•	Secret Store: fully connected network of nodes, which is used to generate and store same set of keys（生成和存储密钥的节点网络）;

•	key scheme: a pair of numbers t and N, expressed as (t+1)-of-N, that is used as a parameter to key generation session:

o	N: is the current number of nodes in Secret Store;

o	t: is the key threshold, meaning that subset of t+1 nodes is required for operations, involving private portion of the key;

•	server key generation session: process of single server key generation, using given server key id and key scheme;

o	server key: EC key pair that has been generated using server key generation session（密钥对）;

o	server key id: 256-bit value, used as unique identifier of server key（密钥对标识符）;

o	server key share: is an artifact of server key generation session, that is stored on each node, participated in this session and can be used later to restore private portion 
of server key（恢复私钥的协议，存储在每一个节点）;

•	document key generation session: process of generating single document key, used to encrypt document:

o	document: some document, that need to be externally-stored in encrypted form（需要以加密形式存储的文件）;

o	document encryption: process of encrypting document contents, running outside of Secret Store (i.e. it is Secret Store client who is choosing encryption algorithm and 
implementing encryption code)（文件加密）;

o	document key: input key for document encryption, which is generated by Secret Store in document key generation session and is stored on nodes, encrypted by server key（公钥加密的文件）;

•	permissioning sessions: are sessions that require access to existing server key shares to compute some values:

o	permissioning contract: blockchain contract, that is used to check if requester has permissions to run permissioning sessions with given server key;

o	document key retrieval session: process of restoring (decrypting) single document key and returning it to the requester;

o	signing session: process of computing message hash’ signature with previously generated server key;

•	key servers set change session: process of migrating secret shares from ‘old’ nodes set to new nodes set, when one/some of nodes are being added/removed to/from Secret Store.

